
# 方法和参数

## 命名空间

* 命名空间是一种分类机制，用于组合功能相关的所有类型。
* 命名空间是分级的，一般从公司名开始，然后是产品名，最后是功能领域。
* 要为命名空间使用Pascal大小写风格。
* 将源代码的文件目录结构组织成与命名空间的层次结构相匹配的形式。
* C#不允许在using指令中使用通配符，每个命名空间都必须显示地导入。
* 可以利用using指令为命名空间或类型取一个别名。

## 方法的参数

### 值参数

* 如果以传值方式传递一个引用类型的变量，引用（地址）本身会从调用者复制给方法参数。其结果就是，虽然目标方法更改不了调用者变量的值，即更改不了引用（地址）本身，但可以更改引用所指向的数据。
* 对于值类型，参数获得的是值得副本，所以在被调用的方法中更改参数不会影响调用者的原始变量。


### 引用参数(ref)

* 这个关键字使参数以传引用的方式传递，使被调用的方法可以用新值来更新调用者的变量。
* 如果被调用的方法将参数指定为ref，那么调用者在调用这个方法的时候，提供的实参必须是附件了ref前缀的变量。
* 调用者应该对传引用的变量进行初始化，因为目标方法可能直接从ref参数读取数据而不先对其进行赋值。
```
string first = "hello";
string second = "world";
swap(ref first, ref second);
void swap(ref string x, ref string y)
{
    string temp = x;
    x = y;
    y = temp;
}
```

### 输出参数(out)

* 方法获取一个变量的引用，并且只向变量中写入而不从中读取。
* out参数在功能上和ref参数完全一致，唯一的区别是，C#语言对别名变量的读写有不同的规定。如果参数被标记成out，编译器会核实在方法所有正常返回的代码路径(不抛出异常的代码路径)中，是否都对该参数进行了赋值。
* 每个正常返回的代码路径都必须对所有out参数进行赋值。


### 参数数组(params)

* 允许在调用方法时提供数量可变得参数，而不是由方法事先固定好参数数量。
* 参数数组不一定是方法的唯一参数，但必须是方法声明中的最后一个参数。由于只有最后一个参数才可能是参数数组，所以方法最多只能有一个参数数组。
* 调用者可以指定和参数数组对应的零个实参，这会造成传递的参数数组包含零个数据项。
* 参数数组是类型安全的，实参的类型必须兼容与参数数组中元素的类型。
* 调用者可以显式地使用数组，而不是以逗号分隔的参数列表，最终生成的CIL代码是一样的。
* 假如目标方法的实现要求一个最起码的参数数量，必须在方法声明中显式指定参数。如: int Max(int first, params int[] operands)。


### 可选参数

* 从C#4.0起，声明方法时将常量值赋给参数，以后调用方法时就不必每个参数都指定。
* 可选参数一定放在所有必须的参数(无默认值的参数)后面。
* 默认值必须是常量，或者说必须是能在编译时确定的值。
* 命名参数: 调用者可以显示地为一个参数赋值，而不需要依据参数顺序赋值。
```
void Display(string firstName, string secondName) 
{
    ......
}
Display(firstName: "abc", secondName: "bcd");
```
* 特别注意: 方法重载、可选参数和命名参数一起使用时，调用哪个方法。

### 异常处理

* 避免从finally块显式地引发异常。
* 要优先使用try/finally而不是try/catch块来实现资源清理代码。
* 所有的异常都派生于System.Exception类，catch块必须从"最具体"到"最不具体"排列。
* 可以指定一个不获取任何参数的catch块，称为常规catch块，等价于catch(object exception){...}，应该避免使用。
* 在C#2.0中，如果遇到用另一种语言编写的代码，而且会引发不是从System.Exception类派生的异常，那么该异常对象会被封装到System.Runtime.CompilerServices.RuntimeWrappedException中，该类从System.Exception派生。
* 有时catch块能捕获到异常，但不能正确或者完整地处理它，可以让这个catch块重新引发异常，具体方法是使用一个单独的throw语句，不要在他后面指定任何异常。
* 要在捕获并重新引发异常时使用空的throw语句，以便保持调用栈。
* 要通过引发异常而不是返回错误码来报告执行失败。
* 不要让公共成员将异常作为返回值或者out参数，要通过异常来指明错误。
* 不要用异常来处理正常的、预期的情况，用异常处理异常的、非预期的情况。



